1   ====================构建镜像==================================
在Dockerfiles所在文件夹下，也即本工程根目录network-x下：
上传修改的代码。
在/data/docker-vol/kg/net-compute/network-x下
运行如下命令：
docker build -t  net-compute:1.0 .
上述命令，name为镜像名称，tag为版本号，
注意不要丢掉命令最后的一个点
注意不要删除requirements.txt文件按


2   ================启动图计算服务=============================
124.70.85.169
账号：root
密码：HTHT123!@#HTHT


临时启动（目前使用）
镜像构建完成后在华为云服务器下运行：
在/data/docker-vol/kg/目录下，运行
docker-compose up -d
看到net-compute-1 done 即服务启动成功。


调用示例：
http://124.70.85.169/kg/algo/pagerank

# docker run  -it --rm --name=net-compute-1 -e port="5000" \
# -v /data/docker-vol/kg/net-compute/network-x:/network-x \ # 只改动服务器的地址
# net-compute:1.0

3 ================接口服务=============================

 a) 数据同步接口调用：
 API地址：http://10.1.40.61:5000/kg/compute/data/synchronization  #IP地质及端口根据实际更改该
 模式: POST
 输入参数:{"kg_name":"452120393941295104"} #指定需要同步的数据空间，如 military-1
 返回参数示例：{
    "code": 0,
    "data": null,
    "message": "正常数据同步任务！"
}

 b) 数据同步状态查看：
 API地址：http://10.1.40.61:5000/kg/compute/data/synchronization/status  #IP地质及端口根据实际更改该
 模式: POST
 输入参数:{"kg_name":"military-1"} #指定需要同步的数据空间，如 military-1
 返回参数示例：{
    "code": 0,
    "data": {
        "status": "completed"  # 有start, synchronizing, completed, error, 四种数据值
    },
    "message": "正常数据同步任务！"
}

 c) 释放图数据内存（服务不准备计算任务时可以释放图数据内存，下次调用pagerank时会重新加载）：
 API地址：http://10.1.40.61:5000/kg/compute/data/release  #IP地质及端口根据实际更改该
 模式: POST
 输入参数:{"kg_name":"military-1"} #指定需要同步的数据空间，如 military-1
 返回参数示例：{
    "code": 0,
    "data": null,
    "message": "释放网络模型military-1成功！"
}



 d) pagerank计算接口调用：
 API地址：http://124.70.85.169/kg/algo/pagerank  #IP地质及端口根据实际更改该
 模式: POST
 输入参数:{"kg_name":"452120393941295104","alpha":0.85,"max_iter":100,"topk":8}
 返回参数示例：
[
    {
        "id": "452125364170563584",
        "name": "马尾港基地",
        "weight": 0.168230120338979
    },
    {
        "id": "452125283883196416",
        "name": "嘉手纳空军基地",
        "weight": 0.07839428716980826
    },
    {
        "id": "452124745284231168",
        "name": "F-16战斗机",
        "weight": 0.07324139136338555
    }
]

 e) lpa社区发现计算接口调用：
 API地址：http://124.70.85.169/kg/algo/lpa  #IP地质及端口根据实际更改该
 模式: POST
 输入参数:{"kg_name":"452120393941295104","seed":1}
 返回参数示例：
     {
        "0": [
            {
                "452126363648040960": "A-10攻击机"
            },
            {
                "452125801409978368": "左营雷达站"
            },
            {
                "452127380670291968": "第909空中加油中队"
            },
            {
                "452123790958436352": "福建号航空母舰"
            },
            {
                "452126294047760384": "维吉尼亚州新港造船厂"
            },
            {
                "452125081185067008": "EA-6B电子战飞机"
            },
            {
                "452123921728446464": "霍华德号导弹驱逐舰"
            },
            {
                "452125364170563584": "马尾港基地"
            },
            {
                "452124161181261824": "自由号濒海战斗舰"
            },
            {
                "452124207985500160": "阿兰达号护卫舰"
            },
            {
                "452124745284231168": "F-16战斗机"
            },
            {
                "452125117956530176": "C-17运输机"
            },
            {
                "452124903510155264": "P-42预警机"
            },
            {
                "452127173018689536": "第14舰载机联队"
            },
            {
                "452127088784482304": "第1驱逐舰中队"
            },
            {
                "452125047584497664": "SH-60F直升机"
            }
        ],
        "1": [
            {
                "452125283883196416": "嘉手纳空军基地"
            },
            {
                "452124863576186880": "P-8A反潜巡逻机"
            },
            {
                "452124966118531072": "KC-46A空中加油机"
            },
            {
                "452127339511586816": "第2轰炸机联队"
            },
            {
                "452126177957814272": "美军空中作战司令部"
            },
            {
                "452124825873588224": "CL-604侦察机"
            },
            {
                "452124780818374656": "B-52H轰炸机"
            },
            {
                "452126892604301312": "南海"
            }
        ],
        "2": [
            {
                "452123963646320640": "美利坚号两栖攻击舰"
            },
            {
                "452124120345518080": "绿湾号两栖船坞运输舰"
            },
            {
                "452124055409303552": "托图加号船坞登陆舰"
            }
        ],
        "3": [
            {
                "452123864019017728": "张伯伦湖号导弹巡洋舰"
            },
            {
                "454582976367599616": "第1航母打击群"
            },
            {
                "452126943317630976": "第3舰队"
            }
        ],
        "4": [
            {
                "452127125396561920": "第11潜艇中队"
            },
            {
                "452124297647136768": "杰斐逊城号攻击型核潜艇"
            }
        ]
    }

  f) shortest_path计算接口调用：
 API地址：http://10.1.40.61:5000/kg/compute/algo/shortest_path  #IP地址及端口根据实际更改
 模式: POST
 输入参数:{"kg_name":"452120393941295104", "source":"452124161181261824", "target":"452120393941295104", "method":"dijkstra"}
 返回参数示例：
{
    "452123790958436352": {
        "452123790958436352": [
            "452123790958436352"
        ],
        "452123864019017728": [
            "452123790958436352",
            "452125364170563584",
            "452123864019017728"
        ],
        "452123921728446464": [
            "452123790958436352",
            "452125364170563584",
            "452123921728446464"
        ],
        "452123963646320640": [
            "452123790958436352",
            "452125364170563584",
            "452123963646320640"
        ],
        "452124055409303552": [
            "452123790958436352",
            "452125364170563584",
            "452123963646320640",
            "452124055409303552"
        ],
        "452124120345518080": [
            "452123790958436352",
            "452125364170563584",
            "452124120345518080"
        ],
        "452124161181261824": [
            "452123790958436352",
            "452125364170563584",
            "452124161181261824"
        ],
        "452124207985500160": [
            "452123790958436352",
            "452124207985500160"
        ],
        "452124297647136768": [
            "452123790958436352",
            "452125364170563584",
            "452124297647136768"
        ],
        "452124745284231168": [
            "452123790958436352",
            "452125364170563584",
            "452124745284231168"
        ]
    },
}
g) simple_path计算接口调用：
 API地址：http://10.1.40.61:5000/kg/compute/algo/simple_path  #IP地址及端口根据实际更改
 模式: POST
 输入参数:{"kg_name":"military-1", "source":None, "target":None}
{"kg_name":"452120393941295104", "source":"452123790958436352", "target":"452124966118531072"}
 返回参数示例：
{
    "0": [
        "452123790958436352",
        "452124863576186880",
        "452124966118531072"
    ],
    "1": [
        "452123790958436352",
        "452125364170563584",
        "452125283883196416",
        "452124966118531072"
    ],
    "2": [
        "452123790958436352",
        "452124863576186880",
        "452125283883196416",
        "452124966118531072"
    ],
    "3": [
        "452123790958436352",
        "452125117956530176",
        "452125283883196416",
        "452124966118531072"
    ],
    "4": [
        "452123790958436352",
        "452126363648040960",
        "452125283883196416",
        "452124966118531072"
    ]
}


h) traversal计算接口调用：
 API地址：http://10.1.40.61:5000/kg/compute/algo/traversal  #IP地址及端口根据实际更改
 模式: POST
 输入参数:{"kg_name":"military-1", "source":None, "depth_limit":None, "method":"dfs"}
{"kg_name":"452120393941295104", "source":"452123790958436352", "method":"dfs"}
 返回参数示例：
 {
    "0": [
        "452123790958436352",
        "452125364170563584"
    ],
    "1": [
        "452125364170563584",
        "452124161181261824"
    ],
    "2": [
        "452125364170563584",
        "452124207985500160"
    ],
    "3": [
        "452124207985500160",
        "452123921728446464"
    ],
    "4": [
        "452123921728446464",
        "452126892604301312"
    ],
    "5": [
        "452126892604301312",
        "452124825873588224"
    ]
}
i)cmc相关性计算接口调用：
 API地址：http://10.1.40.21:5000/kg/compute/algo/cnc  #IP地址及端口根据实际更改
 模式: POST
 输入参数:{"kg_name":"452120393941295104","node":"452124161181261824","alpha":0.8,"topk":3}
 返回参数示例：
 {
    "m_node": "452124161181261824",
    "m_node_name": "自由号濒海战斗舰",
    "relations": [
        {
            "v_node": "452125364170563584",
            "v_node_name": "马尾港基地",
            "value": 4.800000000000001
        },
        {
            "v_node": "452123790958436352",
            "v_node_name": "福建号航空母舰",
            "value": 3.2500000000000004
        },
        {
            "v_node": "452126294047760384",
            "v_node_name": "维吉尼亚州新港造船厂",
            "value": 3.2500000000000004
        }
    ]
}
